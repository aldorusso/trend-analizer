// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model SearchQuery {
  id          String   @id @default(uuid())
  country     String
  query       String
  createdAt   DateTime @default(now())
  trends      Trend[]
  contents    Content[]
}

model Trend {
  id            String      @id @default(uuid())
  searchQueryId String
  searchQuery   SearchQuery @relation(fields: [searchQueryId], references: [id])
  title         String
  description   String?
  traffic       String?
  relatedQueries String?    // JSON string
  createdAt     DateTime   @default(now())
  contents      Content[]
}

model Content {
  id            String      @id @default(uuid())
  searchQueryId String
  searchQuery   SearchQuery @relation(fields: [searchQueryId], references: [id])
  trendId       String?
  trend         Trend?      @relation(fields: [trendId], references: [id])
  platform      String      // Instagram, Twitter, LinkedIn, etc.
  postType      String      // Post, Story, Reel, etc.
  title         String
  description   String
  hashtags      String?
  createdAt     DateTime   @default(now())
}

// Nuevos modelos para FaceBank.PR
model Competitor {
  id          String   @id @default(uuid())
  name        String   @unique // Nombre único del banco/fintech
  instagram   String?  // Handle de Instagram
  website     String?
  category    String   // banco, fintech, neobank
  country     String
  notes       String?  // Notas sobre el competidor
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
  posts       CompetitorPost[]
}

model CompetitorPost {
  id            String      @id @default(uuid())
  competitorId  String
  competitor    Competitor  @relation(fields: [competitorId], references: [id])
  platform      String      // Instagram, LinkedIn, etc.
  postUrl       String?
  postType      String      // Reel, Post, Carousel, Story
  caption       String?     // Texto del post
  engagement    String?     // likes, comments, shares
  topic         String      // Tema del post (cuenta dólares, inversión, etc.)
  whatWorked    String?     // Qué funcionó bien
  ideas         String?     // Ideas para adaptar a FaceBank
  createdAt     DateTime   @default(now())
}

model ContentIdea {
  id          String   @id @default(uuid())
  title       String
  description String
  platform    String
  postType    String
  priority    String   // high, medium, low
  status      String   @default("pending") // pending, in_progress, published
  source      String?  // De dónde salió la idea (competitor, trends, manual)
  notes       String?
  createdAt   DateTime @default(now())
}

// Info de Interés - Posts guardados para análisis
model SavedPost {
  id              String   @id @default(uuid())
  competitorName  String   // Nombre del competidor
  platform        String   // Instagram, Facebook, etc.
  postType        String   // Video, Image, Sidecar, etc.
  postUrl         String   // URL del post
  caption         String?  // Caption completo
  hashtags        String?  // Hashtags como JSON array
  mentions        String?  // Mentions como JSON array
  likesCount      Int?
  commentsCount   Int?
  viewsCount      Int?
  engagement      String?  // Engagement rate
  timestamp       DateTime // Fecha del post original
  rawData         String   // JSON completo del post
  analysis        String?  // Análisis generado por IA
  insights        String?  // Insights y aprendizajes
  tags            String?  // Tags para búsqueda
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}
